/* angular-soil 0.5.0 %> */

(function(){angular.module("soil.collection",[]).factory("soilCollection",["$http",function(a){var b;return b=function(){function b(a){this._modelClass=a,this.members=void 0}return b.prototype.load=function(a){var b=this;return a||(a=[]),this.members=_.map(a,function(a){return new b._modelClass(a)})},b.prototype.get=function(b){var c=this;return a.get(b).success(function(a){return c.load(a)})},b.prototype.add=function(a){return this.members.push(a)},b.prototype.addToFront=function(a){return this.members.unshift(a)},b.prototype.removeById=function(a){return _.remove(this.members,function(b){return b.id===a})},b.prototype.remove=function(a){return _.remove(this.members,function(b){return a===b})},b}()}])}).call(this),function(){angular.module("soil.model",[]).factory("soilModel",["$http",function(a){var b;return b=function(){function b(a){angular.isNumber(a)?this.get(a):angular.isObject(a)&&this.load(a)}return b.prototype._baseUrl="/",b.prototype.setBaseUrl=function(a){return this._baseUrl=a},b.prototype.url=function(a){return null==a&&(a=this.id),a?this._withSlash(this._baseUrl)+a:this._baseUrl},b.prototype.load=function(a){return this._clearFields(),_.assign(this,a),this.savedData=a||{}},b.prototype.get=function(b){var c=this;return a.get(this.url(b)).success(function(a){return c.load(a)})},b.prototype.loaded=function(){return!!this.id},b.prototype.save=function(){var b=this;return this.id?a.put(this.url(),this._dataToSave()).success(function(a){return b.load(a)}):a.post(this.url(),this._dataToSave()).success(function(a){return b.load(a)})},b.prototype["delete"]=function(){var b=this;return this._checkIfLoaded(),a["delete"](this.url()).success(function(){return b.load(null)})},b.prototype.updateField=function(b){var c,d=this;return this._checkIfLoaded(),c={},c[b]=this[b],a.put(this.url(),c).success(function(a){return d[b]=a[b],d.savedData=a}).error(function(){return d[b]=d.savedData[b]})},b.prototype._checkIfLoaded=function(){if(!this.loaded())throw"Operation not permitted on an unloaded model"},b.prototype._clearFields=function(){return _.forOwn(this,function(a,b,c){return"_"!==_.first(b)?delete c[b]:void 0})},b.prototype._withSlash=function(a){return a.replace(/\/?$/,"/")},b.prototype._fieldsToSave=[],b.prototype._dataToSave=function(){var a,b=this;return a={},_.each(this._fieldsToSave,function(c){return a[c]=void 0===b[c]?null:b[c]}),a},b}()}])}.call(this);