/* angular-soil 0.4.0 %> */

(function(){angular.module("soil.collection",[]).factory("soilCollection",["$http",function(a){var b;return b=function(){function b(a,b){if(this._modelClass=a,this._sourceUrl=b,!_.isFunction(this._modelClass))throw"Expected a model class as the first argument when instantiating soilCollection";this.members=void 0}return b.prototype.loadAll=function(){var b=this;return a.get(this._sourceUrl).success(function(a){return b.members=_.map(a,function(a){return new b._modelClass(a)})})},b.prototype.addItem=function(b){var c=this;if(void 0!==this.members)return a.post(this._sourceUrl,b).success(function(a){var b;return b=new c._modelClass(a),c.members.push(b)})},b}()}])}).call(this),function(){angular.module("soil.model",[]).factory("soilModel",["$http",function(a){var b;return b=function(){function b(a){angular.isObject(a)&&this._load(a)}return b.prototype._base_url="/",b.prototype.getById=function(b){var c=this;return a.get(this.url(b)).success(function(a){return c._load(a)})},b.prototype.isLoaded=function(){return!!this.id},b.prototype.url=function(a){return null==a&&(a=this.id),a?this._withSlash(this._base_url)+a:this._base_url},b.prototype.updateField=function(b){var c,d=this;if(this.isLoaded())return c={},c[b]=this[b],a.put(this.url(),c).success(function(a){return d[b]=a[b],d._savedData=a}).error(function(){return d[b]=d._savedData[b]});throw"Cannot update model without an ID"},b.prototype.save=function(){var b=this;if(this.isLoaded())return a.put(this.url(),this._dataToSave()).success(function(a){return b._load(a)});throw"Cannot save model without an ID"},b.prototype._load=function(a){return _.forOwn(this,function(a,b,c){return"_"!==_.first(b)?delete c[b]:void 0}),_.assign(this,a),this._savedData=a||{}},b.prototype._withSlash=function(a){return a.replace(/\/?$/,"/")},b.prototype._fieldsToSave=[],b.prototype._dataToSave=function(){var a,b=this;return a={},_.each(this._fieldsToSave,function(c){return a[c]=void 0===b[c]?null:b[c]}),a},b}()}])}.call(this);